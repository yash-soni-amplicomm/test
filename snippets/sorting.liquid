{%- doc -%}
  Renders the sorting component.

  @param {object} results - The results of the search
  @param {string} sort_by - The current sort by
  @param {string} filter_style - The filter style
  @param {string} [suffix] - { 'desktop' | 'mobile' | 'overflow' } Used on `form` attributes to connect inputs to a form[id]
  @param {string} [sort_position] - { 'desktop' | 'mobile' } Used in a data-testID selector for automated testing
  @param {boolean} should_use_select_on_mobile - Whether to use a select element for the sorting component on mobile
  @param {string} section_id - The section ID
{%- enddoc -%}


{% if floating_btn %}

  <!-- Floating Sort Button -->
  {% comment %} <button
    type="button"
    class="custom-floatBtn-floating-sort-btn-button"
    id="custom-floatBtn-floating-sort-btn-open"
  >
    Sort
  </button>

  <!-- Sort Modal -->
  <div
    class="custom-floatBtn-floating-sort-btn-overlay"
    id="custom-floatBtn-floating-sort-btn-modal"
  >
    <div class="custom-floatBtn-floating-sort-btn-modalBox">

      <!-- Header -->
      <div class="custom-floatBtn-floating-sort-btn-header">
        <h3>Sort By</h3>

        <button
          type="button"
          class="custom-floatBtn-floating-sort-btn-close"
          id="custom-floatBtn-floating-sort-btn-close"
        >
          âœ•
        </button>
      </div>

      <!-- Options -->
      <div class="custom-floatBtn-floating-sort-btn-body">
        {% for option in results.sort_options %}
          <label class="custom-floatBtn-floating-sort-btn-option">
            <input
              type="radio"
              name="custom_sort_by_modal"
              value="{{ option.value }}"
              {% if option.value == sort_by %}checked{% endif %}
            >
            <span>{{ option.name }}</span>
          </label>
        {% endfor %}
      </div>

      <!-- Apply Button -->
      <div class="custom-floatBtn-floating-sort-btn-footer">
        <button
          type="button"
          class="custom-floatBtn-floating-sort-btn-apply"
          id="custom-floatBtn-floating-sort-btn-apply"
        >
          Apply Sorting
        </button>
      </div>

    </div>
  </div> {% endcomment %}

{% else %}

<sorting-filter-component
  class="sorting-filter{% if filter_style == 'horizontal' %} sorting-filter__horizontal{% endif %}"
  on:change="/updateFilterAndSorting"
  on:keydown="/handleKeyDown"
  {% if sort_position != blank %}
    data-testid="sorting-filter-component-{{ sort_position }}"
  {% endif %}
  data-should-use-select-on-mobile="{{ should_use_select_on_mobile }}"
>
  {% liquid
    assign default_sort_by = results.default_sort_by
    for option in results.sort_options
      if option.value == sort_by
        assign status = option.name
      endif
    endfor
  %}
   <div
            class="facets__title-wrapper"
            style="--color-shadow: rgb(var(--color-foreground-rgb) / var(--opacity-10-25));"
          >
            <h2
              id="filters-drawer-heading"
              class="facets-drawer__title h3"
            > Sort
              </h2>
              </div>
 {% comment %} <label
      for="sort-select-{{ section_id }}"
      class="facets__label filters-drawer-heading"
    >
      {{- 'actions.sort' | t -}}
    </label> {% endcomment %}
  <div class="sorting-filter__container {% if should_use_select_on_mobile %} desktop:hidden {% else %} hidden {% endif %}">
   
    {% comment %} <div class="sorting-filter__select-wrapper">
      <select
        id="sort-select-{{ section_id }}"
        name="sort_by"
        class="sorting-filter__select"
        {% if should_use_select_on_mobile == false %}
          disabled
        {% endif %}
      >
        {% for option in results.sort_options %}
          <option
            value="{{ option.value }}"
            {% if option.value == sort_by %}
              selected
            {% endif %}
          >
            {{ option.name }}
          </option>
        {% endfor %}
      </select>
      <svg
        aria-hidden="true"
        focusable="false"
        class="icon icon-caret"
        width="8"
        height="13"
        viewBox="0 0 8 13"
      >
        {%- render 'icon', icon: 'double-sided-caret' -%}
      </svg>
    </div> {% endcomment %}
    <div class="sorting-filter__radio-wrapper">

  {% for option in results.sort_options %}
    <label class="sorting-filter__radio-option">

      <input
        type="radio"
        name="sort_by"
        value="{{ option.value }}"
        {% if option.value == sort_by %}
          checked
        {% endif %}
      >

      <span class="checkbox__label-text">
        {{ option.name }}
      </span>

    </label>
  {% endfor %}

</div>

  </div>

  <accordion-custom
    {% if filter_style == 'horizontal' %}
      data-disable-animation-on-desktop="true"
      data-close-with-escape="true"
    {% endif %}
  >
    <details
      ref="details"
      id="Sorting-{{ section_id }}"
      data-default-sort-by="{{ default_sort_by }}"
      class="facets__panel {% if should_use_select_on_mobile %} mobile:hidden {% endif %}"
      data-auto-close-details="desktop,mobile"
      on:toggle="/handleToggle"
    >
      <summary
        class="facets__summary custom-sort-by"
        role="button"
        aria-expanded="false"
        aria-controls="sorting-options-{{ section_id }}"
        ref="summary"
       >
        <span
          style="color:#757575;font-weight:bold"
          class="facets__label"
          id="sort-label-{{ section_id }}"
        >
          {% comment %} {{- 'actions.sort' | t -}} By :  {% endcomment %}
           Sort By :
          <span style="color:#0F0F0F">
            {% for option in results.sort_options %}
              {% if option.value == sort_by %}
                {{ option.name }}
              {% endif %}
            {% endfor %}
          </span>
        </span>


        <span
          class="facets__status h6 desktop:hidden"
        >
          {{- status -}}
        </span>
        <span class="svg-wrapper icon-caret icon-animated custom-svg-wrapper">
          {{- 'icon-caret.svg' | inline_asset_content -}}
          
        </span>
      </summary>
      <floating-panel-component
        id="sorting-options-{{ section_id }}"
        class="sorting-filter__options color-{{ settings.popover_color_scheme }}"
        role="listbox"
        aria-labelledby="sort-label-{{ section_id }}"
        ref="listbox"
      >
        <div class="sorting-filter__options-inner">
          {% for option in results.sort_options %}
            <label
              for="sort-option-{{ option.value }}-{{ section_id }}"
            >
              <div
                class="sorting-filter__option"
                role="option"
                aria-selected="{% if option.value == sort_by %}true{% else %}false{% endif %}"
                tabindex="{% if option.value == sort_by %}0{% else %}-1{% endif %}"
              >
                <input
                  type="radio"
                  name="sort_by"
                  id="sort-option-{{ option.value }}-{{ section_id }}"
                  {% if suffix != blank %}
                    form="FacetFiltersForm--{{ section_id }}-{{ suffix }}"
                  {% endif %}
                  value="{{ option.value }}"
                  class="sorting-filter__input"
                  data-option-name="{{ option.name }}"
                  {% if option.value == sort_by %}
                    checked
                  {% endif %}
                  aria-hidden="true"
                >
                <span class="svg-wrapper icon-checkmark sorting-filter__checkmark">
                  {{- 'icon-checkmark.svg' | inline_asset_content -}}
                </span>
                <span class="sorting-filter__label">{{ option.name }}</span>
              </div>
            </label>
          {% endfor %}
        </div>
      </floating-panel-component>
    </details>
  </accordion-custom>
</sorting-filter-component>
{% endif %}




{% stylesheet %}
.sorting-filter__radio-wrapper {
  display: flex;
  flex-direction: column;
  gap: 14px;
}

.sorting-filter__radio-option {
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  font-size: 15px;
}

.sorting-filter__radio-option input[type="radio"] {
  width: 16px;
  height: 16px;
  cursor: pointer;
}

.sorting-filter__radio-label {
  font-weight: 500;
  color: #111;
}

  .custom-sort-by{
    border:1px solid #E2E2E2;
    padding: 0 10px;
  }
  .custom-svg-wrapper{
        margin-left: 8px !important;
  }
  .sorting-filter__container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-inline: var(--drawer-padding) 0;
    padding-block: var(--padding-sm);
    margin-inline-end: var(--margin-md);
    position: relative;
  }

  .sorting-filter__container .facets__label {
    font-size: var(--font-h4--size);
  }

  .sorting-filter__select-wrapper {
    display: flex;
    position: relative;
    border-radius: var(--variant-picker-button-radius);
    align-items: center;
    overflow: clip;
    padding: var(--padding-2xs) var(--padding-xs);
  }

  .sorting-filter__select-wrapper:has(:focus-visible) {
    outline: var(--focus-outline-width) solid currentcolor;
    outline-offset: var(--focus-outline-offset);
  }

  .sorting-filter__select-wrapper:has(:focus-visible) .sorting-filter__select {
    outline: none;
  }

  .sorting-filter__container .sorting-filter__select {
    appearance: none;
    border: 0;
    margin: 0;
    cursor: pointer;
    width: 100%;
    padding-inline-end: var(--icon-size-2xs);
    text-align: right;

    /* Needed for Safari */
    text-align-last: right;
  }

  .sorting-filter__select .icon {
    position: absolute;
    right: var(--padding-md);
    top: 50%;
    transform: translateY(-50%);
    width: var(--icon-size-2xs);
    height: var(--icon-size-2xs);
    pointer-events: none;
  }

  .sorting-filter {
    @media screen and (min-width: 750px) {
      z-index: var(--facets-upper-z-index);
    }
  }

  .sorting-filter__options {
    display: grid;
    grid-template-rows: 0fr;
    opacity: 0;
    position: absolute;
    top: 100%;
    right: 0;
    color: var(--color-foreground);
    z-index: var(--facets-upper-z-index);
    box-shadow: var(--shadow-popover);
    border: var(--style-border-popover);
    background-color: var(--color-background);
    border-radius: var(--style-border-radius-popover);
    width: max-content;
    min-width: var(--facets-panel-min-width);
    min-height: 0;

    transition: grid-template-rows var(--animation-speed-slow) var(--animation-easing),
      opacity var(--animation-speed-slow) var(--animation-easing);
  }

  details[open] .sorting-filter__options {
    opacity: 1;
    grid-template-rows: 1fr;
  }

  .sorting-filter__options-inner {
    display: flex;
    flex-direction: column;
    grid-row: 1 / span 2;
    gap: var(--gap-sm);
    padding: calc(var(--drawer-padding) / 2);
    color: var(--color-foreground);
    overflow: clip;
    scrollbar-width: none;
    -ms-overflow-style: none;

    &::-webkit-scrollbar {
      display: none;
    }

    @media screen and (min-width: 750px) {
      gap: 0;
    }
  }

  .sorting-filter__option {
    cursor: pointer;
    display: grid;
    grid-template-columns: var(--icon-size-sm) 1fr;
    gap: var(--margin-2xs);
    align-items: center;
    min-width: 180px;
    max-width: 16em;
    padding: var(--padding-2xs) calc(var(--drawer-padding) / 2) var(--padding-2xs) var(--padding-2xs);

    &:hover {
      border-radius: calc(var(--style-border-radius-popover) / 2);
      background-color: rgb(var(--color-foreground-rgb) / var(--opacity-8));
    }

    &:focus {
      border-radius: calc(var(--style-border-radius-popover) / 2);
    }
  }

  .sorting-filter__input {
    display: none;

    &:checked + .sorting-filter__checkmark + .sorting-filter__label {
      font-weight: 500;
    }
  }

  .sorting-filter__checkmark {
    visibility: hidden;
  }

  *:checked ~ .sorting-filter__checkmark {
    visibility: visible;
  }

  .sorting-filter__label {
    cursor: pointer;
    pointer-events: none;
  }

  .facets-toggle--no-filters .sorting-filter__select-wrapper {
    @media screen and (max-width: 749px) {
      padding-inline-start: 0;
    }
  }

  .facets-mobile-wrapper .sorting-filter .facets__panel {
    padding-inline: 0;
    position: relative;
  }

  .facets-mobile-wrapper .sorting-filter .facets__status {
    display: none;
  }

  .facets-mobile-wrapper:has(> :nth-child(2)) .sorting-filter .sorting-filter__options {
    left: 0;
    right: unset;
  }

  .facets-mobile-wrapper .sorting-filter .facets__label {
    margin-inline-end: var(--margin-2xs);
    font-size: var(--font-paragraph--size);
    color: var(--color-foreground-muted);
  }

  .facets-toggle .sorting-filter__container {
    @media screen and (max-width: 749px) {
      padding: 0;
    }
  }

  .facets-toggle .sorting-filter__container .facets__label {
    @media screen and (max-width: 749px) {
      display: none;
    }
  }

  .facets-toggle .sorting-filter::before {
    @media screen and (max-width: 749px) {
      display: none;
    }
  }

  .facets--drawer .sorting-filter {
    @media screen and (min-width: 750px) {
      display: none;
    }
  }
{% endstylesheet %}
<style>
  /* Floating Button */
.custom-floatBtn-floating-sort-btn-button {
 
  font-size: 14px;
  cursor: pointer;
}

/* Overlay */
.custom-floatBtn-floating-sort-btn-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.6);

  display: none;
  justify-content: center;
  align-items: flex-end;

  z-index: 10000;
}

.custom-floatBtn-floating-sort-btn-overlay.active {
  display: flex;
}

/* Modal Box */
.custom-floatBtn-floating-sort-btn-modalBox {
  width: 100%;
  max-width: 500px;
  background: #fff;

  border-radius: 18px 18px 0 0;
  padding: 20px;
}

/* Header */
.custom-floatBtn-floating-sort-btn-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.custom-floatBtn-floating-sort-btn-header h3 {
  margin: 0;
  font-size: 18px;
}

/* Close Button */
.custom-floatBtn-floating-sort-btn-close {
  border: none;
  background: none;
  font-size: 20px;
  cursor: pointer;
}

/* Options */
.custom-floatBtn-floating-sort-btn-body {
  margin-top: 15px;
}

.custom-floatBtn-floating-sort-btn-option {
  display: flex;
  align-items: center;
  gap: 10px;

  padding: 12px 0;
  border-bottom: 1px solid #eee;

  cursor: pointer;
  font-size: 15px;
}

/* Footer */
.custom-floatBtn-floating-sort-btn-footer {
  margin-top: 15px;
}

/* Apply Button */
.custom-floatBtn-floating-sort-btn-apply {
  width: 100%;
  padding: 14px;

  border: none;
  border-radius: 10px;

  background: black;
  color: white;

  font-size: 15px;
  cursor: pointer;
}

  </style>
<script>
document.addEventListener("DOMContentLoaded", function () {

  const openBtn = document.getElementById("custom-floatBtn-floating-sort-btn-open");
  const closeBtn = document.getElementById("custom-floatBtn-floating-sort-btn-close");
  const modal = document.getElementById("custom-floatBtn-floating-sort-btn-modal");
  const applyBtn = document.getElementById("custom-floatBtn-floating-sort-btn-apply");

  if (!openBtn || !modal) return;

  /* Open Modal */
  openBtn.addEventListener("click", function () {
    modal.classList.add("active");
  });

  /* Close Modal */
  closeBtn.addEventListener("click", function () {
    modal.classList.remove("active");
  });

  /* Close when clicking outside modal */
  modal.addEventListener("click", function (e) {
    if (e.target === modal) {
      modal.classList.remove("active");
    }
  });

  /* Apply Sorting */
  applyBtn.addEventListener("click", function () {

    const selected = modal.querySelector(
      "input[name='custom_sort_by_modal']:checked"
    );

    if (!selected) return;

    const url = new URL(window.location.href);
    url.searchParams.set("sort_by", selected.value);

    window.location.href = url.toString();
  });

});
document.querySelectorAll('input[name="sort_by"]').forEach((radio) => {
  radio.addEventListener("change", () => {
    radio.closest("form")?.submit();
  });
});

</script>
